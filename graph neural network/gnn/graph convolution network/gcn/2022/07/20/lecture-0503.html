<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Lecture 5.1 - Collective Classification - Belief Propagation | CS224W-KOR</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Lecture 5.1 - Collective Classification - Belief Propagation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="CS224W Lecture 5." />
<meta property="og:description" content="CS224W Lecture 5." />
<link rel="canonical" href="https://cs224w-kor.github.io/blog/graph%20neural%20network/gnn/graph%20convolution%20network/gcn/2022/07/20/lecture-0503.html" />
<meta property="og:url" content="https://cs224w-kor.github.io/blog/graph%20neural%20network/gnn/graph%20convolution%20network/gcn/2022/07/20/lecture-0503.html" />
<meta property="og:site_name" content="CS224W-KOR" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-07-20T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Lecture 5.1 - Collective Classification - Belief Propagation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-20T00:00:00-05:00","datePublished":"2022-07-20T00:00:00-05:00","description":"CS224W Lecture 5.","headline":"Lecture 5.1 - Collective Classification - Belief Propagation","mainEntityOfPage":{"@type":"WebPage","@id":"https://cs224w-kor.github.io/blog/graph%20neural%20network/gnn/graph%20convolution%20network/gcn/2022/07/20/lecture-0503.html"},"url":"https://cs224w-kor.github.io/blog/graph%20neural%20network/gnn/graph%20convolution%20network/gcn/2022/07/20/lecture-0503.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://cs224w-kor.github.io/blog/feed.xml" title="CS224W-KOR" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">CS224W-KOR</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">Questions</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Lecture 5.1 - Collective Classification - Belief Propagation</h1><p class="page-description">CS224W Lecture 5.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-07-20T00:00:00-05:00" itemprop="datePublished">
        Jul 20, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#Graph Neural Network">Graph Neural Network</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#GNN">GNN</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#Graph Convolution Network">Graph Convolution Network</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#GCN">GCN</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#53---collective-classification--belief-propagation">5.3 - Collective Classification : Belief Propagation</a>
<ul>
<li class="toc-entry toc-h2"><a href="#collective-classification--belief-propagation">Collective Classification : Belief Propagation</a>
<ul>
<li class="toc-entry toc-h3"><a href="#collective-classification-models">Collective Classification Models</a></li>
<li class="toc-entry toc-h3"><a href="#loopy-belief-propagation">Loopy Belief Propagation</a></li>
<li class="toc-entry toc-h3"><a href="#message-passing-basics">Message Passing: Basics</a></li>
<li class="toc-entry toc-h3"><a href="#message-passing-algorithm">Message Passing: Algorithm</a></li>
<li class="toc-entry toc-h3"><a href="#message-passing-basics-1">Message Passing: Basics</a></li>
<li class="toc-entry toc-h3"><a href="#generalizing-to-a-tree">Generalizing to a Tree</a></li>
<li class="toc-entry toc-h3"><a href="#message-passing-in-a-tree">Message passing in a tree</a></li>
<li class="toc-entry toc-h3"><a href="#loopy-bp-algorithm">Loopy BP Algorithm</a></li>
<li class="toc-entry toc-h3"><a href="#notation">Notation</a></li>
<li class="toc-entry toc-h3"><a href="#loopy-bp-algorithm-1">Loopy BP Algorithm</a></li>
<li class="toc-entry toc-h3"><a href="#example-loopy-belief-propagation">Example: Loopy Belief Propagation</a></li>
<li class="toc-entry toc-h3"><a href="#what-can-go-wrong">What Can Go Wrong?</a></li>
<li class="toc-entry toc-h3"><a href="#advantages-of-belief-propagation">Advantages of Belief Propagation</a></li>
<li class="toc-entry toc-h3"><a href="#summary">Summary</a></li>
</ul>
</li>
</ul>
</li>
</ul><hr>
<blockquote>
  <p><strong>Lecture 5</strong></p>

  <ul>
    <li><a href="">Lecture 5.1 - Message passing and Node Classification</a></li>
    <li><a href="">Lecture 5.2 - Relational and Iterative Classification</a></li>
    <li><a href="">Lecture 5.3 - Collective Classification : Belief Propagation</a></li>
  </ul>

</blockquote>

<hr>

<h1 id="53---collective-classification--belief-propagation">
<a class="anchor" href="#53---collective-classification--belief-propagation" aria-hidden="true"><span class="octicon octicon-link"></span></a>5.3 - Collective Classification : Belief Propagation</h1>

<h2 id="collective-classification--belief-propagation">
<a class="anchor" href="#collective-classification--belief-propagation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Collective Classification : Belief Propagation</h2>

<h3 id="collective-classification-models">
<a class="anchor" href="#collective-classification-models" aria-hidden="true"><span class="octicon octicon-link"></span></a>Collective Classification Models</h3>

<ul>
  <li>Relational classifiers</li>
  <li>Iterative classification</li>
  <li>
    <p>Loopy belief propagation</p>
  </li>
  <li>ê´€ê³„ ë¶„ë¥˜ì</li>
  <li>ë°˜ë³µêµ¬ë¶„</li>
  <li>ë£¨í”¼ ì‹ ì•™ ì „íŒŒ</li>
</ul>

<aside>
ğŸ’¬ ë¨¼ì € ì§€ê¸ˆê¹Œì§€ ë°°ìš´ ë‚´ìš©ìœ¼ë¡œëŠ” ê° ë…¸ë“œëŠ” ì´ì›ƒ ë…¸ë“œì˜ í™•ë¥ ì˜ ê°€ì¤‘í‰ê· ì„ ìì‹ ì˜ ìƒˆë¡œìš´ í™•ë¥ ë¡œ ì‚¼ê³  ìˆë‹¤.

í˜¹ì€ ê° ë…¸ë“œëŠ” ì´ì›ƒ ë…¸ë“œì˜ ë ˆì´ë¸”ì„ í™œìš©í•´ ìì‹ ì˜ ìƒˆë¡œìš´ í™•ë¥ ì„ ê³„ì‚°í•˜ê²Œ ëœë‹¤. 

ì¦‰, ì´ì›ƒë…¸ë“œì˜ ì •ë³´ê°€ ê°ê°ì˜ ë…¸ë“œì—ì„œ ì‚¬ìš©ë˜ê³  ìˆëŠ” ê²ƒì´ë‹¤.

ì´ê²ƒì„ ê° ë…¸ë“œëŠ” ì´ì›ƒë…¸ë“œì—ê²Œ Beliefë¥¼ ì „ë‹¬ë°›ëŠ”ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. 

ì¦‰ ì´ì›ƒ ë…¸ë“œì˜ beliefë¥¼ ë°›ì•„ ìì‹ ì˜ beliefë¥¼ ìƒì„±í•œë‹¤. 

ë‹¤ë¥´ê²Œ ë§í•˜ë©´, ëª¨ë¸ì€ ê° ë…¸ë“œì— ëŒ€í•´ ë°ì´í„°ë§ˆë‹¤ beliefë¥¼ ê°€ì§€ê³  ìˆê³ , ì´ì›ƒ ë…¸ë“œì˜ beliefë¥¼ ì´ìš©í•´ ê° ë…¸ë“œì˜ beliefë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ìˆë‹¤.

ê·¸ë ‡ë‹¤ë©´ ì™œ êµ³ì´ ë°”ë¡œ ì´ì›ƒë…¸ë“œì—ì„œë§Œ beliefë¥¼ ë°›ì•„ì•¼ í• ê¹Œ. 

ì¢€ ë” ë¨¼ ë…¸ë“œì˜ beliefë„ ì¤‘ìš”í•˜ê²Œ ì‘ë™í•˜ì§€ ì•Šì„ê¹Œ? 

ì™œëƒí•˜ë©´ ê²°êµ­ ì´í„°ë ˆì´ì…˜ì„ ë°˜ë³µí•˜ì—¬ ì´ì›ƒë…¸ë“œì˜ beliefë¥¼ ë°›ê²Œ ëœë‹¤ë©´, í•´ë‹¹ beliefëŠ” ì´ì›ƒë…¸ë“œì˜ ì´ì›ƒë…¸ë“œì˜ beliefê°€ ì„ì—¬ìˆëŠ” ìƒíƒœê¸° ë•Œë¬¸ì—, ì´í„°ë ˆì´ì…˜ì„ ë°˜ë³µí•œë‹¤ëŠ” ê²ƒì€ ìì‹ ì˜ ì´ì›ƒë…¸ë“œì˜ ì´ì›ƒë…¸ë“œì˜ ì´ì›ƒë…¸ë“œì˜ .... beliefë¥¼ ë°›ê³  ìˆëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì´ë‹¤. 

ì´ë¥¼ ì—­ìœ¼ë¡œ ìƒê°í•˜ì—¬ beliefê°€ ê·¸ë˜í”„ì— ì§ì ‘ íë¥´ë„ë¡ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬ì„±í•œ ê²ƒì´ loopy belief propagationì´ ëœë‹¤.

</aside>

<h3 id="loopy-belief-propagation">
<a class="anchor" href="#loopy-belief-propagation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Loopy Belief Propagation</h3>

<ul>
  <li>Belief Propagation is a dynamic programming approach to answering probability queries in a graph (e.g. probability of node $v$ belonging to class 1 )</li>
  <li>
    <p>Iterative process in which neighbor nodes â€œtalkâ€ to each other, passing messages</p>

    <aside>
  ğŸ“Œ "I (node v) believe you (node u) belong to class 1 with likelihood ..."
    
  </aside>
  </li>
  <li>
    <p>When consensus is reached, calculate final belief</p>
  </li>
  <li>ë¯¿ìŒ ì „íŒŒëŠ” ê·¸ë˜í”„ì—ì„œ í™•ë¥  ì¿¼ë¦¬ì— ì‘ë‹µí•˜ëŠ” ë™ì  í”„ë¡œê·¸ë˜ë° ì ‘ê·¼ë²•ì´ë‹¤(ì˜ˆ: í´ë˜ìŠ¤ 1ì— ì†í•˜ëŠ” ë…¸ë“œ $v$ì˜ í™•ë¥ ).</li>
  <li>
    <p>ì¸ì ‘ ë…¸ë“œê°€ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ë©´ì„œ ì„œë¡œ â€œëŒ€í™”â€í•˜ëŠ” ë°˜ë³µ í”„ë¡œì„¸ìŠ¤</p>

    <aside>
  ğŸ“Œ "ë‚˜(ë…¸ë“œ v)ëŠ” (ë…¸ë“œ u)ê°€ í´ë˜ìŠ¤ 1ì— ì†í•œë‹¤ê³  ë¯¿ê³  ìˆìŠµë‹ˆë‹¤.â€
    
  </aside>
  </li>
  <li>í•©ì˜ê°€ ì´ë£¨ì–´ì§€ë©´ ìµœì¢… ë¯¿ìŒì„ ê³„ì‚°í•©ë‹ˆë‹¤.</li>
</ul>

<aside>
ğŸ’¬ Belief Propagation í™•ë¥  ì¿¼ë¦¬ì— ì‘ë‹µí•˜ê¸° ìœ„í•œ ë™ì  í”„ë¡œê·¸ë˜ë° ì ‘ê·¼ë²•ì´ë‹¤.

ë˜í•œ ë°˜ë³µì ìœ¼ë¡œ ì´ì›ƒë…¸ë“œì™€ 'talk'í•˜ë©´ì„œ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ë²•ì´ë‹¤. 

ë”°ë¼ì„œ ì£¼ëœ ì•„ì´ë””ì–´ëŠ” ê° ë…¸ë“œëŠ” ë©”ì‹œì§€ë¥¼ ì´ì›ƒìœ¼ë¡œë¶€í„° ì–»ëŠ”ë‹¤. 

ê·¸ë¦¬ê³  ì—…ë°ì´íŠ¸í•˜ê³  ì•ìœ¼ë¡œ ì „ë‹¬í•œë‹¤.

</aside>

<h3 id="message-passing-basics">
<a class="anchor" href="#message-passing-basics" aria-hidden="true"><span class="octicon octicon-link"></span></a>Message Passing: Basics</h3>

<ul>
  <li>Task: Count the number of nodes in a graph*</li>
  <li>Condition: Each node can only interact (pass message) with its neighbors</li>
  <li>
    <p>Example: path graph</p>
  </li>
  <li>ê³¼ì œ: ê·¸ë˜í”„ì˜ ë…¸ë“œ ìˆ˜ ê³„ì‚°*</li>
  <li>ì¡°ê±´: ê° ë…¸ë“œëŠ” ì¸ì ‘ ë…¸ë“œì™€ë§Œ ìƒí˜¸ ì‘ìš©(ë©”ì‹œì§€ ì „ë‹¬)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>ì˜ˆ: ê²½ë¡œ ê·¸ë˜í”„</li>
</ul>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled.png" alt="Untitled"></p>

<p>Potential issues when the graph contains cycles.</p>

<p>Weâ€™ll get back to it later!</p>

<p>ê·¸ë˜í”„ì— ì£¼ê¸°ê°€ í¬í•¨ë˜ì–´ ìˆì„ ë•Œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œ.</p>

<p>ë‚˜ì¤‘ì— ë‹¤ì‹œ ì–˜ê¸°í•˜ì!</p>

<aside>
ğŸ’¬ ìœ„ì™€ ê°™ì´ ê°€ì¥ ë‹¨ìˆœí•œ ê·¸ë˜í”„ì˜ í˜•íƒœë¥¼ ìƒê°í•´ë³´ì.

ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê²ƒì€ ê·¸ë˜í”„ì˜ ë…¸ë“œ ìˆ˜ë¥¼ ê³„ì‚°í•˜ê³ ì í•œë‹¤. 

ì´ë•Œ beliefëŠ” ê° ì´í„°ë ˆì´ì…˜ë§ˆë‹¤ ì´ì›ƒ ë…¸ë“œë¡œë§Œ ì „ë‹¬ë  ìˆ˜ ìˆë‹¤.

</aside>

<h3 id="message-passing-algorithm">
<a class="anchor" href="#message-passing-algorithm" aria-hidden="true"><span class="octicon octicon-link"></span></a>Message Passing: Algorithm</h3>

<ul>
  <li>Task: Count the number of nodes in a graph</li>
  <li>Algorithm:
    <ul>
      <li>Define an ordering of nodes (that results in a path)</li>
      <li>Edge directions are according to order of nodes
        <ul>
          <li>Edge direction defines the order of message passing</li>
        </ul>
      </li>
      <li>For node $i$ from 1 to 6
        <ul>
          <li>Compute the message from node $i$ to $i+1$ (number of nodes counted so far)</li>
          <li>Pass the message from node $i$ to $i+1$</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ê³¼ì œ: ê·¸ë˜í”„ì˜ ë…¸ë“œ ìˆ˜ ê³„ì‚°</li>
  <li>ì•Œê³ ë¦¬ì¦˜:
    <ul>
      <li>ë…¸ë“œ ìˆœì„œ ì •ì˜(ê²½ë¡œ ìƒì„±)</li>
      <li>ì—ì§€ ë°©í–¥ì€ ë…¸ë“œ ìˆœì„œì— ë”°ë¦…ë‹ˆë‹¤.
        <ul>
          <li>ì—ì§€ ë°©í–¥ì€ ë©”ì‹œì§€ ì „ë‹¬ ìˆœì„œë¥¼ ì •ì˜í•©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>ë…¸ë“œ $i$ì˜ ê²½ìš° 1 ~ 6ê¹Œì§€
        <ul>
          <li>ë…¸ë“œ $i$ì—ì„œ $i+1$ë¡œ ë©”ì‹œì§€ ê³„ì‚° (ì§€ê¸ˆê¹Œì§€ ì¹´ìš´íŠ¸ëœ ë…¸ë“œ ìˆ˜)</li>
          <li>ë…¸ë“œ $i$ì—ì„œ $i+1$ë¡œ ë©”ì‹œì§€ ì „ë‹¬</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled.png" alt="Untitled"></p>

<aside>
ğŸ’¬ ì•Œê³ ë¦¬ì¦˜ì€ ë‹¤ìŒê³¼ ê°™ì„ ê²ƒì´ë‹¤.

1. ë…¸ë“œì˜ ìˆœì„œë¥¼ ì •í•œë‹¤.
2. 1ì—ì„œ ì •í•œ ìˆœì„œì— ë”°ë¼ ì—£ì§€ì˜ ë°©í–¥ì„ ì •í•œë‹¤.
3. $i$ë²ˆì§¸ ë…¸ë“œì— ëŒ€í•´ ë‹¤ìŒì„ ì‹œí–‰í•œë‹¤.
    
    $i-1$ ë…¸ë“œì—ì„œ belief(ì´ì „ê¹Œì§€ ì§€ë‚˜ì˜¨ ë…¸ë“œì˜ ìˆ˜)ë¥¼ ë°›ëŠ”ë‹¤.
    
    beliefì— $1$(ìì‹ ì— ëŒ€í•œ count)ì„ ë”í•œë‹¤.
    
    $i+1$ ë…¸ë“œë¡œ beliefë¥¼ ì „ë‹¬í•œë‹¤.
    
</aside>

<h3 id="message-passing-basics-1">
<a class="anchor" href="#message-passing-basics-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Message Passing: Basics</h3>

<p>Task: Count the number of nodes in a graph Condition: Each node can only interact (pass message) with its neighbors</p>

<p>Solution: Each node listens to the message from its neighbor, updates it, and passes it forward</p>

<p>$m$ : the message</p>

<p>ì‘ì—…: ê·¸ë˜í”„ì˜ ë…¸ë“œ ìˆ˜ ê³„ì‚° ì¡°ê±´: ê° ë…¸ë“œëŠ” ì¸ì ‘ ë…¸ë“œì™€ë§Œ ìƒí˜¸ ì‘ìš©(ë©”ì‹œì§€ ì „ë‹¬)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì†”ë£¨ì…˜: ê° ë…¸ë“œëŠ” ì¸ì ‘ ë…¸ë“œë¡œë¶€í„° ë©”ì‹œì§€ë¥¼ ìˆ˜ì‹ í•˜ê³  ì—…ë°ì´íŠ¸í•œ í›„ ì „ë‹¬</p>

<p>$m$ : ë©”ì‹œì§€</p>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%201.png" alt="Untitled"></p>

<aside>
ğŸ’¬ ê·¸ë˜í”„ì˜ ë…¸ë“œì˜ ìˆ˜ë¥¼ ì„¸ëŠ” ë°©ë²•ì„ êµ¬í•˜ê¸° ìœ„í•´ì„œ ìœ„ì—ì„œ ë³¸ ì•Œê³ ë¦¬ì¦˜ì„ ë”°ë¼ ë¨¼ì € ë…¸ë“œì˜ ìˆœì„œì™€ ê·¸ì— ë”°ë¥¸ ë°©í–¥ì„ ì •í•´ì¤€ë‹¤.

ê·¸ë¦¬ê³  ë‚œë’¤ë¡œ ì´ì „ ë…¸ë“œë¡œ ë¶€í„° messageë¥¼ ì „ë‹¬ë°›ê³ (listen) í˜„ì¬ë…¸ë“œì—ì„œ ë©”ì‹œì§€ë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ì•ì˜ ë…¸ë“œë¡œ ì „ë‹¬í•´ì¤€ë‹¤.

</aside>

<h3 id="generalizing-to-a-tree">
<a class="anchor" href="#generalizing-to-a-tree" aria-hidden="true"><span class="octicon octicon-link"></span></a>Generalizing to a Tree</h3>

<ul>
  <li>We can perform message passing not only on a path graph, but also on a tree-structured graph</li>
  <li>
    <p>Define order of message passing from leaves to root</p>
  </li>
  <li>ê²½ë¡œ ê·¸ë˜í”„ë¿ë§Œ ì•„ë‹ˆë¼ íŠ¸ë¦¬ êµ¬ì¡° ê·¸ë˜í”„ì—ì„œë„ ë©”ì‹œì§€ ì „ë‹¬ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>ë¦¬í”„ì—ì„œ ë£¨íŠ¸ë¡œ ì „ë‹¬ë˜ëŠ” ë©”ì‹œì§€ ìˆœì„œ ì •ì˜</li>
</ul>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%202.png" alt="Untitled.png"></p>

<aside>
ğŸ’¬ ê°™ì€ ì•Œê³ ë¦¬ì¦˜ì„ ìœ„ì™€ ê°™ì€ íŠ¸ë¦¬ êµ¬ì¡°ì— ì ìš©í•œë‹¤.

íŠ¸ë¦¬ëŠ” parentì™€ childë¡œ êµ¬ì„±ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, ì „ì²´ ë…¸ë“œì˜ ìˆ˜ë¥¼ ì„¸ê¸° ìœ„í•´ì„œ childì—ì„œ parent ë°©í–¥ìœ¼ë¡œ beliefê°€ íë¥´ë©´ ë  ê²ƒì´ë‹¤.

</aside>

<h3 id="message-passing-in-a-tree">
<a class="anchor" href="#message-passing-in-a-tree" aria-hidden="true"><span class="octicon octicon-link"></span></a>Message passing in a tree</h3>

<p>Update beliefs in tree structure</p>

<p>íŠ¸ë¦¬ êµ¬ì¡°ì˜ ì‹ ë¢° ì—…ë°ì´íŠ¸</p>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%203.png" alt="Untitled"></p>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%204.png" alt="Untitled"></p>

<aside>
ğŸ’¬ ì´ë•Œ ì™¼ìª½ ê·¸ë¦¼ê³¼ ê°™ì´ parent ë…¸ë“œëŠ” ìì‹ ì˜ child ë…¸ë“œì˜ beliefë¥¼ ë°›ì•„ ì¢…í•©í•˜ëŠ” ì¼ì¢…ì˜ ê³„ì‚°ì„ ìˆ˜í–‰í•œ ìˆ˜ ìì‹ ì˜ parent ë…¸ë“œë¡œ beliefë¥¼ ë„˜ê²¨ì£¼ê²Œ ëœë‹¤.

ì´ë¥¼ í†µí•´ ìµœì¢…ì ìœ¼ë¡œ root ë…¸ë“œì—ì„œ ì „ì²´ ë…¸ë“œì˜ ìˆ˜ë¥¼ êµ¬í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

í•˜ì§€ë§Œ ì‹¤ì œë¡œ countë¥¼ beliefë¡œ ê°„ì£¼í•˜ê³  ì´ì›ƒ ë…¸ë“œì— ì „ë‹¬í•˜ì§€ ì•Šì„ ê²ƒì´ë‹¤. 

ì‹¤ì œë¡œ ì•Œê³ ë¦¬ì¦˜ì´ ì–´ë–»ê²Œ ë˜ì–´ ìˆëŠ”ì§€ ì‚´í´ë³´ì.

</aside>

<h3 id="loopy-bp-algorithm">
<a class="anchor" href="#loopy-bp-algorithm" aria-hidden="true"><span class="octicon octicon-link"></span></a>Loopy BP Algorithm</h3>

<p>What message will $i$ send to $j$ ?</p>

<ul>
  <li>It depends on what $i$ hears from its neighbors</li>
  <li>Each neighbor passes a message to $i$ its beliefs of the state of $i$</li>
</ul>

<p>$i$ê°€ $j$ì— ë³´ë‚¼ ë©”ì‹œì§€ëŠ” ë¬´ì—‡ì…ë‹ˆê¹Œ?</p>

<ul>
  <li>$i$ê°€ ì´ì›ƒìœ¼ë¡œë¶€í„° ë¬´ì—‡ì„ ë“£ëŠëƒì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤.</li>
  <li>ê° ì´ì›ƒì€ $i$ ìƒíƒœì— ëŒ€í•œ ë¯¿ìŒì„ $i$ì— ì „ë‹¬í•œë‹¤.</li>
</ul>

<aside>
ğŸ“Œ I (node $i$ ) believe that you (node $j$ ) belong to class $Y_{j}$ with probability $\cdots$

</aside>

<aside>
ğŸ“Œ I(ë…¸ë“œ $i$)ëŠ” ë‹¹ì‹ (ë…¸ë“œ $j$)ì´ í™•ë¥ ë¡œ í´ë˜ìŠ¤ $Y_{j}$ì— ì†í•œë‹¤ê³  ë¯¿ëŠ”ë‹¤$\cdots$

</aside>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%205.png" alt="Untitled"></p>

<aside>
ğŸ’¬ ì¼ë°˜ì ìœ¼ë¡œëŠ” ì—¬ëŸ¬ ë…¸ë“œì˜ ì •ë³´ë¥¼ $i$ë…¸ë“œë¡œ ì „ë‹¬í•˜ê³ (hear) $i$ë…¸ë“œì—ì„œ $j$ë…¸ë“œë¡œ ì „ë‹¬í•œë‹¤.

</aside>

<h3 id="notation">
<a class="anchor" href="#notation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Notation</h3>

<ul>
  <li>
    <p>Label-label potential matrix $\psi$ : Dependency between a node and its neighbor.</p>

    <p>$\boldsymbol{\psi}\left(Y_{i}, Y_{j}\right)$ is proportional to the probability of a node $j$ being in class $Y_{j}$ given that it has neighbor $i$ in class $Y_{i}$.</p>
  </li>
  <li>Prior belief $\phi: \phi\left(Y_{i}\right)$ is proportional to the probability of node $i$ being in class $Y_{i}$.</li>
  <li>$m_{i \rightarrow j}\left(Y_{j}\right)$ is $i^{\prime}$ s message / estimate of $j$ being in class $Y_{j}$.</li>
  <li>
    <p>$\mathcal{L}$ is the set of all classes/labels</p>
  </li>
  <li>
    <p>ë ˆì´ë¸” ë ˆì´ë¸” ì ì¬ì  ë§¤íŠ¸ë¦­ìŠ¤ $\psi$ : ë…¸ë“œì™€ ì¸ì ‘ ë…¸ë“œ ê°„ì˜ ì¢…ì†ì„±.</p>

    <p>$\boldsymbol{\psi}\left(Y_{i}, Y_{j}\right)$ëŠ” ë…¸ë“œ $j$ê°€ í´ë˜ìŠ¤ $Y_{j}$ì— ìˆì„ í™•ë¥ ì— ë¹„ë¡€í•œë‹¤.</p>
  </li>
  <li>$\phi: \phi\left(Y_{i}\right)$ëŠ” ë…¸ë“œ $i$ê°€ í´ë˜ìŠ¤ $Y_{i}$ì— í¬í•¨ë  í™•ë¥ ì— ë¹„ë¡€í•œë‹¤.</li>
  <li>$m_{i \rightarrow j}\left(Y_{j}\right)$ëŠ” í´ë˜ìŠ¤ $Y_{j}$ì— ì†í•˜ëŠ” $j$ì˜ $i^{\prime}$ ë©”ì‹œì§€/ì¶”ì •ì´ë‹¤.</li>
  <li>$\mathcal{L}$ ëŠ” ëª¨ë“  í´ë˜ìŠ¤/ë¼ë²¨ì˜ ì§‘í•©ì…ë‹ˆë‹¤.</li>
</ul>

<aside>
ğŸ’¬ **Notation**

- $\psi$ (Label-Label Potential Matrix) : $\psi$ ëŠ” ê° ë…¸ë“œê°€ ì´ì›ƒë…¸ë“œì˜ í´ë˜ìŠ¤ì— ëŒ€í•œ ì˜í–¥ë ¥(ë¹„ë¡€)ì„ í–‰ë ¬ë¡œ í‘œí˜„í•œ ê²ƒì´ë‹¤.
    - ì˜ˆë¥¼ ë“¤ì–´ $\psi\left(Y_{i}, Y_{j}\right)$ ëŠ” ì´ì›ƒ ë…¸ë“œ iì˜ ë ˆì´ë¸”ì´ $Y_{i}$ ì¼ ë•Œ, ë…¸ë“œ $\mathrm{j}$ ê°€ $Y_{j}$ ë ˆì´ë¸”ì— ì†í•  í™•ë¥ ì˜ ë¹„ì¤‘ì´ë‹¤.
    - ë§Œì•½ $i$ì™€ $j$ê°€ Homophilyê°€ ì¡´ì¬í•œë‹¤ë©´(ê°™ì€ classë¥¼ ê°€ì§„ë‹¤ë©´) ëŒ€ê°ì›ì†Œë“¤ì˜ í¬ê¸°ëŠ” ë†’ì„ê²ƒì´ë‹¤.
    - ë˜í•œ ì´ í–‰ë ¬ì„ ì–»ê¸°ìœ„í•´ì„œëŠ” í•™ìŠµì´ í•„ìš”í•˜ë‹¤.
- $\phi$ (Prior Belief) : ë…¸ë“œ $i$ê°€ $Y_{i}$ ì— ì†í•  í™•ë¥ ì— ë¹„ë¡€í•œë‹¤.
- $m_{i \rightarrow j}\left(Y_{j}\right)$ : $i$ì˜ ë©”ì„¸ì§€ê°€ $j$ë¡œ ì „ë‹¬ë˜ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ë°, $i$ê°€ ì´ì›ƒ ë…¸ë“œë¡œ ë¶€í„° ë°›ì€ beliefì™€ ìì‹ ì˜ ì •ë³´ë¥¼ ì¢…í•©í•´ $j$ì˜ ë ˆì´ë¸”ì„ believeí•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
    - $j$ì˜ ë…¸ë“œë¥¼ ì˜ˆì¸¡í•  ìˆ˜ ìˆë„ë¡ $i$ì—ì„œ $j$ë¡œ ì „ë‹¬í•˜ëŠ” ë©”ì‹œì§€ì´ë‹¤.
- $L:$ ëª¨ë“  ë ˆì´ë¸”(í´ë˜ìŠ¤)ì„ í¬í•¨í•˜ëŠ” ì§‘í•©
- $b_{i}\left(Y_{i}\right)$ : ë…¸ë“œ iì˜ í´ë˜ìŠ¤ê°€ $Y_{i}$ ì¼ belief
</aside>

<h3 id="loopy-bp-algorithm-1">
<a class="anchor" href="#loopy-bp-algorithm-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Loopy BP Algorithm</h3>

<ol>
  <li>Initialize all messages to 1</li>
  <li>
    <p>Repeat for each node:</p>
  </li>
  <li>ëª¨ë“  ë©”ì‹œì§€ë¥¼ 1ë¡œ ì´ˆê¸°í™”</li>
  <li>ê° ë…¸ë“œì— ëŒ€í•´ ë°˜ë³µí•©ë‹ˆë‹¤.</li>
</ol>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%206.png" alt="Untitled"></p>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%207.png" alt="Untitled.png"></p>

<p>After convergence: $b_{i}\left(Y_{i}\right)=$ node $i$ â€˜s belief of being in class $Y_{i}$</p>

<p>ìˆ˜ë ´ í›„: $b_{i}\left(Y_{i}\right)=$ ë…¸ë“œ $i$ì˜ í´ë˜ìŠ¤ $Y_{i}$ì— ëŒ€í•œ ë¯¿ìŒ</p>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%208.png" alt="Untitled.png"></p>

<aside>
ğŸ’¬ 1. ê°€ì¥ ì²˜ìŒì—ëŠ” ëª¨ë“  ë…¸ë“œì˜ ë©”ì„¸ì§€ë¥¼ 1ë¡œ ì´ˆê¸°í™”í•œë‹¤.

2. ì´í›„ ê°€ìš´ë° ì´ë¯¸ì§€ì™€ ê°™ì´ ëª¨ë“  ë…¸ë“œì— ëŒ€í•´ ë‹¤ìŒ ë…¸ë“œë¡œ ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•˜ëŠ” ê³¼ì •ì„ ë°˜ë³µí•œë‹¤.

ì´ë•Œ ê°€ìš´ë° ì´ë¯¸ì§€ì˜ ìˆ˜ì‹ì„ ì„¤ëª…í•´ë³´ìë©´, ê°€ì¥ ì•ì˜ ë¶„í™ìƒ‰ ë¶€ë¶„ì€ í˜„ì¬ ë…¸ë“œ $i$ì˜ ëª¨ë“  ë ˆì´ë¸”ì˜ ê°€ëŠ¥ì„±ì— ëŒ€í•´ ë°˜ë³µí•˜ì—¬ ë”í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

ë…¹ìƒ‰ ë¶€ë¶„ì€ label-label potentialë¡œì„œ, $i$ë…¸ë“œì˜ ê° ë ˆì´ë¸”ë§ˆë‹¤ $j$ë…¸ë“œê°€ $Y_{j}$ ë ˆì´ë¸”ì„ ê°€ì§ˆ í™•ë¥ ì„ ê³„ì‚°í•˜ê²Œ ëœë‹¤. 

ì ìƒ‰ ë¶€ë¶„ì€ Priorë¡œì„œ $i$ë…¸ë“œê°€ $Y_{i}$ ë ˆì´ë¸”ì„ ê°€ì§ˆ í™•ë¥ ì„ ê³„ì‚°í•˜ê²Œ ëœë‹¤. 

ì²­ìƒ‰ ë¶€ë¶„ì€ $i$ ë…¸ë“œê°€ ë©”ì„¸ì§€ë¥¼ ë„˜ê²¨ë°›ëŠ” ì´ì›ƒ ë…¸ë“œì—ì„œ $i$ ë…¸ë“œê°€ $Y_{i}$ ë ˆì´ë¸”ì¼ beliefë¥¼ ë„˜ê²¨ ë°›ëŠ” ë¶€ë¶„ì´ë‹¤.

ë§Œì•½ ìœ„ì˜ ê³¼ì •ì´ ì¶©ë¶„íˆ ë°˜ë³µë˜ì–´ ìˆ˜ë ´í•œë‹¤ë©´ ì„¸ë²ˆì§¸ ì´ë¯¸ì§€ì— í•´ë‹¹í•˜ëŠ” ì‹¤ì œ í™•ë¥  $[b_{i}\left(Y_{i}\right)]$ì´ ê³„ì‚°ë˜ê²Œ ëœë‹¤.

1. ì¦‰, Prior í™•ë¥ ì— beliefë¥¼ ëª¨ë‘ ê³±í•˜ì—¬ ìµœì¢…ì ì¸ belief ($[b_{i}\left(Y_{i}\right)]$) ë¥¼ ê²°ì •í•œë‹¤.
</aside>

<aside>
ğŸ’¡ Q: ìˆ˜ë ´ í•˜ëŠ” ê²ƒì´ ë¬´ì—‡ì¸ì§€? ë¬´ì—‡ì´ ìˆ˜ë ´í•˜ëŠ” ê²ƒì¸ì§€ ìƒí™©ì— ëŒ€í•œ ì§ˆë¬¸

</aside>

<h3 id="example-loopy-belief-propagation">
<a class="anchor" href="#example-loopy-belief-propagation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example: Loopy Belief Propagation</h3>

<ul>
  <li>Now we consider a graph with cycles</li>
  <li>There is no longer an ordering of nodes</li>
  <li>We apply the same algorithm as in previous slides:
    <ul>
      <li>Start from arbitrary nodes</li>
      <li>Follow the edges to update the neighboring nodes</li>
    </ul>
  </li>
</ul>

<p>What if our graph has cycles?</p>

<p>Messages from different subgraphs are no longer independent!</p>

<p>But we can still run BP, but it will pass messages in loops.</p>

<ul>
  <li>ì´ì œ ì£¼ê¸°ê°€ ìˆëŠ” ê·¸ë˜í”„ë¥¼ ì‚´í´ë´…ì‹œë‹¤.</li>
  <li>ë” ì´ìƒ ë…¸ë“œ ìˆœì„œê°€ ì—†ìŠµë‹ˆë‹¤.</li>
  <li>ì´ì „ ìŠ¬ë¼ì´ë“œì™€ ë™ì¼í•œ ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•©ë‹ˆë‹¤.
    <ul>
      <li>ì„ì˜ ë…¸ë“œì—ì„œ ì‹œì‘</li>
      <li>ê°€ì¥ìë¦¬ë¥¼ ë”°ë¼ ì¸ì ‘ ë…¸ë“œë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p>ë§Œì•½ ìš°ë¦¬ ê·¸ë˜í”„ì— ì£¼ê¸°ê°€ ìˆë‹¤ë©´?</p>

<p>ë‹¤ë¥¸ í•˜ìœ„ ê·¸ë˜í”„ì˜ ë©”ì‹œì§€ëŠ” ë” ì´ìƒ ë…ë¦½ì ì´ì§€ ì•ŠìŠµë‹ˆë‹¤!</p>

<p>í•˜ì§€ë§Œ BPëŠ” ì—¬ì „íˆ ì‹¤í–‰í•  ìˆ˜ ìˆì§€ë§Œ ë©”ì‹œì§€ë¥¼ ë£¨í”„ í˜•íƒœë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.</p>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%209.png" alt="Untitled"></p>

<aside>
ğŸ’¬ ì§€ê¸ˆê¹Œì§€ ì´ì•¼ê¸°í•œ ê·¸ë˜í”„ë“¤ì€ ìˆœí™˜í•˜ëŠ” êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆì§€ ì•Šì•„ ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•  ìˆœì„œë¥¼ ì •í•˜ëŠ”ë° ë¬¸ì œê°€ ì—†ì—ˆë‹¤.

í•˜ì§€ë§Œ ìˆœí™˜í•˜ëŠ” êµ¬ì¡°ë¥¼ ê°€ì§€ëŠ” ê·¸ë˜í”„ì˜ ê²½ìš°ì—ëŠ” ë‹¨ìˆœí•˜ê²Œ ë…¸ë“œì˜ ìˆœì„œë¥¼ ì •í•´ì„œ ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•˜ë„ë¡ ë§Œë“¤ ìˆ˜ ì—†ë‹¤. 

ê·¸ì— ëŒ€í•´ ìì„¸íˆ ì‚´í´ë³´ì.

ë§Œì•½ ìœ„ì™€ ê°™ì€ ê·¸ë˜í”„ê°€ ìˆê³ , ìœ„ì™€ ê°™ì€ ìˆœì„œë¡œ ë©”ì„¸ì§€ë¥¼ ì£¼ê³  ë°›ëŠ”ë‹¤ê³  ìƒê°í•´ë³´ì. 

$u$ ë…¸ë“œëŠ” $k$ì—ê²Œ ë©”ì„¸ì§€ë¥¼ ë°›ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ìê¸° ìì‹ ì˜ ë©”ì„¸ì§€ë§ˆì € ë°›ê³  ìˆëŠ” ìƒí™©ì´ë‹¤. 

ì¦‰, ë” ì´ìƒ ëª¨ë“  ë…¸ë“œê°€ ë…ë¦½ì ì´ì§€ ì•Šê³ , ì˜ì¡´ì„±ì´ ìƒê¸´ë‹¤. 

ìˆœì„œê°€ ë°˜ëŒ€ë¡œ íŠ¸ë¦¬ì™€ ê°™ì´ $j$ê°€ $i, k$ë¡œ ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•˜ê³ , $i, k$ê°€ $u$ë¡œ ë©”ì„¸ì§€ë¥¼ ì „ë‹¬í•œë‹¤ë©´, $j$ì˜ ë©”ì„¸ì§€ëŠ” $u$ì—ê²Œ ì¤‘ë³µë˜ì–´ ë‘ ë²ˆ ì „ë‹¬ë˜ëŠ” ë¬¸ì œê°€ ìƒê¸´ë‹¤.

ì´ë ‡ê²Œ ë˜ë©´ ì•Œê³ ë¦¬ì¦˜ì´ í¬ê²Œ ë¬¸ì œê°€ ìƒê¸°ëŠ” ê²ƒ ê°™ì§€ë§Œ, ì‹¤ì œ ì ìš©í•´ë³´ë‹ˆ ê·¸ë ‡ì§€ ì•Šë‹¤ê³  í•œë‹¤. 

ì‹¤ì œ ê·¸ë˜í”„ë“¤ì€ ë¬´ì²™ í¬ê³ , ê±°ê¸°ì— ìˆœí™˜í•˜ëŠ” cycle êµ¬ì¡°ëŠ” ê·¸ë ‡ê²Œ í° ë¶€ë¶„ì„ ì°¨ì§€í•˜ì§€ ì•ŠëŠ”ë° ë°˜ë©´, ì „ì²´ êµ¬ì¡°ëŠ” ë§¤ìš° ë³µì¡í•˜ê¸° ë•Œë¬¸ì— Loopy BP ì•Œê³ ë¦¬ì¦˜ì´ ì˜ ì‘ë™í•œë‹¤ê³  í•œë‹¤.

</aside>

<h3 id="what-can-go-wrong">
<a class="anchor" href="#what-can-go-wrong" aria-hidden="true"><span class="octicon octicon-link"></span></a>What Can Go Wrong?</h3>

<ul>
  <li>Beliefs may not converge</li>
  <li>Message $m_{u \rightarrow i}\left(Y_{i}\right)$ is based on initial belief of $i$, not a separate evidence for $i$</li>
  <li>The initial belief of $i$ (which could be incorrect) is reinforced by the cycle</li>
</ul>

<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>i</mi><mo>â†’</mo><mi>j</mi><mo>â†’</mo><mi>k</mi><mo>â†’</mo><mi>u</mi><mo>â†’</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">i \rightarrow j \rightarrow k \rightarrow u \rightarrow i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>

<ul>
  <li>
    <p>However, in practice, Loopy BP is still a good heuristic for complex graphs which contain many branches.</p>
  </li>
  <li>ì‹ ë…ì´ ìˆ˜ë ´ë˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.</li>
  <li>ë©”ì‹œì§€ $m_{u \rightarrow i}\left(Y_{i}\right)$ëŠ” $i$ì— ëŒ€í•œ ë³„ë„ì˜ ì¦ê±°ê°€ ì•„ë‹ˆë¼ $i$ì˜ ì´ˆê¸° ë¯¿ìŒì— ê¸°ì´ˆí•œë‹¤.</li>
  <li>(ì˜ëª»ë  ìˆ˜ ìˆìŒ) $i$ì˜ ì´ˆê¸° ì‹ ë…ì€ ì£¼ê¸°ì— ì˜í•´ ê°•í™”ëœë‹¤.</li>
</ul>

<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>i</mi><mo>â†’</mo><mi>j</mi><mo>â†’</mo><mi>k</mi><mo>â†’</mo><mi>u</mi><mo>â†’</mo><mi>i</mi></mrow><annotation encoding="application/x-tex">i \rightarrow j \rightarrow k \rightarrow u \rightarrow i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">â†’</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span></span>

<ul>
  <li>ê·¸ëŸ¬ë‚˜ ì‹¤ì œë¡œ Loopy BPëŠ” ë§ì€ ë¶„ê¸°ë¥¼ í¬í•¨í•˜ëŠ” ë³µì¡í•œ ê·¸ë˜í”„ì— ì—¬ì „íˆ ì¢‹ì€ íœ´ë¦¬ìŠ¤í‹±ì´ë‹¤.</li>
</ul>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%209.png" alt="Untitled"></p>

<ul>
  <li>Messages loop around and around: $2,4,8,16,32, \ldots$ More and more convinced that these variables are $T$ !</li>
  <li>BP incorrectly treats this message as separate evidence that the variable is $\mathrm{T}$!.</li>
  <li>Multiplies these two messages as if they were independent.
    <ul>
      <li>But they donâ€™t actually come from independent parts of the graph.</li>
      <li>One influenced the other (via a cycle).</li>
    </ul>
  </li>
  <li>ë©”ì‹œì§€ëŠ” ëŒê³  ëˆë‹¤: $2,4,8,16,32,\ldots$ ì´ëŸ¬í•œ ë³€ìˆ˜ê°€ $T$ì„ì„ ì ì  ë” í™•ì‹ í•˜ê²Œ ëœë‹¤!</li>
  <li>BPëŠ” ì´ ë©”ì‹œì§€ë¥¼ ë³€ìˆ˜ê°€ $\mathrm{T}$ë¼ëŠ” ë³„ë„ì˜ ì¦ê±°ë¡œ ì˜ëª» ì·¨ê¸‰í•œë‹¤.</li>
  <li>ì´ ë‘ ë©”ì‹œì§€ë¥¼ ë…ë¦½í•œ ê²ƒì²˜ëŸ¼ ê³±í•©ë‹ˆë‹¤.
    <ul>
      <li>í•˜ì§€ë§Œ ê·¸ê²ƒë“¤ì€ ì‚¬ì‹¤ ê·¸ë˜í”„ì˜ ë…ë¦½ì ì¸ ë¶€ë¶„ì—ì„œ ë‚˜ì˜¨ ê²ƒì´ ì•„ë‹™ë‹ˆë‹¤.</li>
      <li>í•œ ì‚¬ëŒì´ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ì˜í–¥ì„ ì£¼ì—ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p><img src="5%203%20-%20Collective%20Classification%20Belief%20Propagation%201798fd49b34d470bb364e98b6c68514a/Untitled%2010.png" alt="Untitled"></p>

<p>This is an extreme example.</p>

<p>Often in practice, the cyclic influences are weak.</p>

<p>(As cycles are long or include at least one weak correlation.)</p>

<p>ì´ê²ƒì€ ê·¹ë‹¨ì ì¸ ì˜ˆì…ë‹ˆë‹¤.</p>

<p>ì‹¤ì œë¡œ, ì£¼ê¸°ì ì¸ ì˜í–¥ì€ ì•½í•˜ë‹¤.</p>

<p>(ì£¼ê¸°ê°€ ê¸¸ê±°ë‚˜ í•˜ë‚˜ ì´ìƒì˜ ì•½í•œ ìƒê´€ ê´€ê³„ë¥¼ í¬í•¨í•˜ê¸° ë•Œë¬¸ì—)</p>

<aside>
ğŸ’¬

</aside>

<h3 id="advantages-of-belief-propagation">
<a class="anchor" href="#advantages-of-belief-propagation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Advantages of Belief Propagation</h3>

<ul>
  <li>Advantages:
    <ul>
      <li>Easy to program &amp; parallelize</li>
      <li>General: can apply to any graph model with any form of potentials
        <ul>
          <li>Potential can be higher order: e.g. $\boldsymbol{\psi}\left(Y_{i}, Y_{j}, Y_{k}, Y_{v} \ldots\right)$</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>Challenges:
    <ul>
      <li>Convergence is not guaranteed (when to stop), especially if many closed loops</li>
    </ul>
  </li>
  <li>Potential functions (parameters)
    <ul>
      <li>Require training to estimate</li>
    </ul>
  </li>
  <li>ì¥ì :
    <ul>
      <li>í”„ë¡œê·¸ë˜ë° ë° ë³‘ë ¬í™”ê°€ ìš©ì´í•¨</li>
      <li>ì¼ë°˜: ëª¨ë“  í˜•íƒœì˜ ì ì¬ë ¥ì´ ìˆëŠ” ê·¸ë˜í”„ ëª¨ë¸ì— ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        <ul>
          <li>ì ì¬ë ¥ì€ ê³ ì°¨ì¼ ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ $\boldsymbol{\psi}\left(Y_{i}, Y_{j}, Y_{k}, Y_{v} \ldots\right)$</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>ê³¼ì œ:
    <ul>
      <li>íŠ¹íˆ ë‹«íŒ ë£¨í”„ê°€ ë§ì€ ê²½ìš° ìˆ˜ë ´ì´ ë³´ì¥ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤(ì •ì§€ ì‹œê¸°).</li>
    </ul>
  </li>
  <li>ì ì¬ì  í•¨ìˆ˜(ëª¨ìˆ˜)
    <ul>
      <li>í‰ê°€í•˜ë ¤ë©´ êµìœ¡ í•„ìš”</li>
    </ul>
  </li>
</ul>

<aside>
ğŸ’¬ **Advantages:**

1. ì½”ë”©ì´ ì‰½ê³ , ë³‘ë ¬í™”ê°€ ê°€ëŠ¥í•˜ë‹¤.
2. ì–´ë– í•œ ê·¸ë˜í”„ ëª¨ë¸ì´ë”ë¼ë„, potential matrixë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë²”ìš©ì ì´ë‹¤.

**Challenges:**

1. ìˆ˜ë ´ì´ ë³´ì¥ë˜ì§€ ì•Šì•„ ì–¸ì œ ë©ˆì¶°ì•¼ í• ì§€ ì•Œ ìˆ˜ ì—†ìœ¼ë©°, íŠ¹íˆ ìˆœí™˜êµ¬ì¡°ì¼ ê²½ìš° ìˆ˜ë ´ì´ ë³´ì¥ë˜ì§€ ì•Šì•„ ë°˜ë³µíšŸìˆ˜ë¥¼ ì§€ì •í•´ì£¼ì–´ì•¼ í•œë‹¤.
2. cycle êµ¬ì¡°ë¡œ ì¸í•´ ì¢…ì¢… ì ì€ ì´í„°ë§Œ ëŒë¦¬ê¸°ë„ í•œë‹¤.
</aside>

<h3 id="summary">
<a class="anchor" href="#summary" aria-hidden="true"><span class="octicon octicon-link"></span></a>Summary</h3>

<ul>
  <li>We learned how to leverage correlation in graphs to make prediction on nodes</li>
  <li>Key techniques:
    <ul>
      <li>Relational classification</li>
      <li>Iterative classification</li>
      <li>Loopy belief propagation</li>
    </ul>
  </li>
  <li>ìš°ë¦¬ëŠ” ê·¸ë˜í”„ì˜ ìƒê´€ ê´€ê³„ë¥¼ í™œìš©í•˜ì—¬ ë…¸ë“œì— ëŒ€í•œ ì˜ˆì¸¡ì„ í•˜ëŠ” ë°©ë²•ì„ ë°°ì› ë‹¤.</li>
  <li>ì£¼ìš” ê¸°ìˆ :
    <ul>
      <li>ê´€ê³„êµ¬ë¶„</li>
      <li>ë°˜ë³µêµ¬ë¶„</li>
      <li>ë£¨í”¼ ì‹ ì•™ ì „íŒŒ</li>
    </ul>
  </li>
</ul>

<aside>
ğŸ’¬

</aside>

<hr>

<p><a href="../Lecture%205%200439f07c33674421b9e4ad4977ff3af5.md">Lecture 5</a></p>

<table>
  <tbody>
    <tr>
      <td>[CS224W: Machine Learning with Graphs</td>
      <td>2021</td>
      <td>Lecture 5.3 - Collective Classification](https://www.youtube.com/watch?v=kh3I_UTtUOo&amp;list=PLoROMvodv4rPLKxIpqhjhPgdQy7imNkDn&amp;index=16)</td>
    </tr>
  </tbody>
</table>

  </div><!-- from https://github.com/utterance/utterances
<script src="https://utteranc.es/client.js"
        repo="CS224W-KOR/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>-->

<div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://cs224w-kor.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="u-url" href="/blog/graph%20neural%20network/gnn/graph%20convolution%20network/gcn/2022/07/20/lecture-0503.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>CS224W ê°•ì˜ë¥¼ ê³µë¶€í•˜ëŠ” ê¸€ë˜ ê·¸ë˜í”„ ìŠ¤í„°ë”” ë¸”ë¡œê·¸</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/cs224w-kor" target="_blank" title="cs224w-kor"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
