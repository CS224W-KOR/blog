<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Lecture 17.3 - Cluster GCN - Scaling up GNNs | CS224W-KOR</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Lecture 17.3 - Cluster GCN - Scaling up GNNs" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="CS224W Lecture 17. Scaling Up Graph Neural Networks to Large Graphs" />
<meta property="og:description" content="CS224W Lecture 17. Scaling Up Graph Neural Networks to Large Graphs" />
<link rel="canonical" href="https://cs224w-kor.github.io/blog/gnn/scalable/large%20graph/graphsage/cluster%20gcn/simplified%20gcn/2022/09/07/lecture-1703.html" />
<meta property="og:url" content="https://cs224w-kor.github.io/blog/gnn/scalable/large%20graph/graphsage/cluster%20gcn/simplified%20gcn/2022/09/07/lecture-1703.html" />
<meta property="og:site_name" content="CS224W-KOR" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-09-07T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Lecture 17.3 - Cluster GCN - Scaling up GNNs" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-07T00:00:00-05:00","datePublished":"2022-09-07T00:00:00-05:00","description":"CS224W Lecture 17. Scaling Up Graph Neural Networks to Large Graphs","headline":"Lecture 17.3 - Cluster GCN - Scaling up GNNs","mainEntityOfPage":{"@type":"WebPage","@id":"https://cs224w-kor.github.io/blog/gnn/scalable/large%20graph/graphsage/cluster%20gcn/simplified%20gcn/2022/09/07/lecture-1703.html"},"url":"https://cs224w-kor.github.io/blog/gnn/scalable/large%20graph/graphsage/cluster%20gcn/simplified%20gcn/2022/09/07/lecture-1703.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://cs224w-kor.github.io/blog/feed.xml" title="CS224W-KOR" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">CS224W-KOR</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">Questions</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Lecture 17.3 - Cluster GCN - Scaling up GNNs</h1><p class="page-description">CS224W Lecture 17. Scaling Up Graph Neural Networks to Large Graphs</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-09-07T00:00:00-05:00" itemprop="datePublished">
        Sep 7, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      6 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#GNN">GNN</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#scalable">scalable</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#large graph">large graph</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#GraphSAGE">GraphSAGE</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#Cluster GCN">Cluster GCN</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#Simplified GCN">Simplified GCN</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#issues-with-neighbor-sampling">Issues with Neighbor Sampling</a></li>
<li class="toc-entry toc-h1"><a href="#insight-from-full-batch-gnn">Insight from Full-batch GNN</a></li>
<li class="toc-entry toc-h1"><a href="#subgraph-sampling">Subgraph Sampling</a></li>
<li class="toc-entry toc-h1"><a href="#exploiting-community-structure">Exploiting Community Structure</a></li>
<li class="toc-entry toc-h1"><a href="#cluster-gcn">Cluster-GCN</a></li>
<li class="toc-entry toc-h1"><a href="#issues-with-cluster-gcn">Issues with Cluster-GCN</a></li>
<li class="toc-entry toc-h1"><a href="#advanced-cluster-gcn-overview">Advanced Cluster-GCN: Overview</a></li>
<li class="toc-entry toc-h1"><a href="#advanced-cluster-gcn">Advanced Cluster-GCN</a></li>
<li class="toc-entry toc-h1"><a href="#comparison-of-time-complexity">Comparison of Time Complexity</a></li>
<li class="toc-entry toc-h1"><a href="#summary-cluster-gcn">Summary: Cluster-GCN</a></li>
</ul><hr>

<blockquote>
  <p><strong>Lecture 17. Scaling Up Graph Neural Networks to Large Graphs</strong></p>

  <ul>
    <li><a href="https://cs224w-kor.github.io/blog/gnn/scalable/large%20graph/graphsage/cluster%20gcn/simplified%20gcn/2022/09/07/lecture-1701.html">Lecture 17.1 - Scaling up Graph Neural Networks</a></li>
    <li><a href="https://cs224w-kor.github.io/blog/gnn/scalable/large%20graph/graphsage/cluster%20gcn/simplified%20gcn/2022/09/07/lecture-1702.html">Lecture 17.2 - GraphSAGE Neighbor Sampling</a></li>
    <li><a href="https://cs224w-kor.github.io/blog/gnn/scalable/large%20graph/graphsage/cluster%20gcn/simplified%20gcn/2022/09/07/lecture-1703.html">Lecture 17.3 - Cluster GCN: Scaling up GNNs</a></li>
    <li><a href="https://cs224w-kor.github.io/blog/gnn/scalable/large%20graph/graphsage/cluster%20gcn/simplified%20gcn/2022/09/07/lecture-1704.html">Lecture 17.4 - Scaling up by Simplifying GNNs</a></li>
  </ul>

</blockquote>

<hr>

<h1 id="issues-with-neighbor-sampling">
<a class="anchor" href="#issues-with-neighbor-sampling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Issues with Neighbor Sampling</h1>

<p>17.2ì—ì„œ ë§í–ˆë“¯ì´ Neighbor Sampling ë°©ì‹ìœ¼ë¡œ mini-batchë¥¼ êµ¬ì„±í•˜ëŠ”ë°ëŠ” ì—¬ëŸ¬ ë¬¸ì œì ì´ ìˆìŠµë‹ˆë‹¤.</p>

<ul>
  <li>
<strong>Computation graphì˜ í¬ê¸°ê°€ GNN layerì˜ ê°¯ìˆ˜ì— ëŒ€í•´ ì§€ìˆ˜ì ìœ¼ë¡œ ì¦ê°€</strong>í•˜ì—¬ ê³„ì‚° íš¨ìœ¨ì„±ì´ í¬ê²Œ ë–¨ì–´ì§€ê²Œ ë©ë‹ˆë‹¤.</li>
  <li>
<strong>ìƒ˜í”Œë§ ëœ ì´ì›ƒ ë…¸ë“œë“¤ì´ ë§ì´ ê²¹ì¹˜ëŠ” ê²½ìš°, redundantí•œ ê³„ì‚°ì´ ë§ì´ ì¼ì–´ë‚˜ê¸° ë•Œë¬¸ì— íš¨ìœ¨ì ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.</strong> ì•„ë˜ ê·¸ë¦¼ì—ì„œ ë³´ë‹¤ì‹œí”¼ ë…¸ë“œ Cì™€ DëŠ” ë‘ computation graphì— ëª¨ë‘ í¬í•¨ë˜ì–´ ì—¬ëŸ¬ë²ˆ ë¶ˆí•„ìš”í•˜ê²Œ ì—°ì‚°ì— ì°¸ì—¬í•˜ê²Œ ë©ë‹ˆë‹¤.</li>
</ul>

<p><img src="https://i.imgur.com/qKxOpZP.png" alt="Imgur"></p>

<h1 id="insight-from-full-batch-gnn">
<a class="anchor" href="#insight-from-full-batch-gnn" aria-hidden="true"><span class="octicon octicon-link"></span></a>Insight from Full-batch GNN</h1>

<p>ì´ëŸ¬í•œ ë¹„íš¨ìœ¨ì„±ì„ ì–´ë–»ê²Œ í•´ê²°í•˜ë©´ ì¢‹ì„ê¹Œìš”? í•´ë‹µì€ full-batch GNNì—ì„œ ì–»ì„ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ full-batchë¥¼ ë– ì˜¬ë ¤ë³´ì£ .</p>

<p><img src="https://i.imgur.com/WwJ9UuP.png" alt="Imgur"></p>

<p>Full-batch trainingìœ¼ë¡œ í•™ìŠµí•  ë•Œ, í•œ GNN layerì—ì„œ ìœ„ ì‹ì„ í†µí•´ ëª¨ë“  ë…¸ë“œì˜ ì„ë² ë”©ì„ ë™ì‹œì— ì—…ë°ì´íŠ¸ í•©ë‹ˆë‹¤. <strong>ì¼ê´„ì ìœ¼ë¡œ $l-1$ë²ˆì§¸ layerì˜ ë…¸ë“œ ì„ë² ë”©ì„ í•œë²ˆì”©ë§Œ ì‚¬ìš©í•˜ì—¬ $l$ë²ˆì§¸ layerì˜ ë…¸ë“œ ì„ë² ë”©ì„ ìƒì„±í•˜ê¸° ë•Œë¬¸ì— Neighbor Samplingì—ì„œì²˜ëŸ¼ redundantí•œ ì—°ì‚°ì€ ì¼ì–´ë‚˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤.</strong> ì´ë¥¼ ë” ìì„¸íˆ ë“¤ì—¬ë‹¤ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ë™ì‘í•˜ê²Œ ë©ë‹ˆë‹¤.</p>

<p><img src="https://i.imgur.com/8gbMkky.png" alt="Imgur"></p>

<ul>
  <li>í•˜ë‚˜ì˜ GNN layerì„ ê¸°ì¤€ìœ¼ë¡œ computation graphë¥¼ ë§Œë“¤ê³  ìì‹œê³  í•  ê²ƒ ì—†ì´ ì „ì²´ ê·¸ë˜í”„ì— ëŒ€í•´ ì¼ê´„ì ìœ¼ë¡œ ë…¸ë“œ ì„ë² ë”©ì„ ìƒì„±í•©ë‹ˆë‹¤. ì´ ë•Œ ëª¨ë“  ì—£ì§€ì— ëŒ€í•´ ì–‘ë°©í–¥ìœ¼ë¡œ ë‘ ë²ˆì˜ message passingì´ ì¼ì–´ë‚©ë‹ˆë‹¤.
<br>â†’ <strong>ì‹œê°„ ë³µì¡ë„</strong> $\propto O(2*no.(edges))$</li>
  <li>$K$-layer GNNì„ ê¸°ì¤€ìœ¼ë¡œ í•˜ë©´,
<br>â†’ <strong>ì‹œê°„ ë³µì¡ë„</strong> $\propto O(2K*no.(edges))$</li>
</ul>

<p>ë”°ë¼ì„œ full-batch trainingì˜ ì‹œê°„ ë³µì¡ë„ëŠ” ì—£ì§€ì˜ ê°¯ìˆ˜ì™€ GNN layerì˜ ê°¯ìˆ˜ì— ì„ í˜• ë¹„ë¡€í•˜ê¸° ë•Œë¬¸ì— ì´ë¡ ì ìœ¼ë¡  êµ‰ì¥íˆ ë¹¨ë¼ì•¼ í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ, ìš°ë¦¬ê°€ ë‹¤ë£¨ëŠ” ê·¸ë˜í”„ê°€ í° ê·¸ë˜í”„ì¸ë§Œí¼ ì—£ì§€ì˜ ìˆ˜ê°€ êµ‰~ì¥íˆ í¬ê³  ì „ì²´ ê·¸ë˜í”„ë¥¼ GPU ë©”ëª¨ë¦¬ ìƒì— ë¡œë”©í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— full-batch trainingì„ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê²ƒì´ì—ˆì£ .</p>

<h1 id="subgraph-sampling">
<a class="anchor" href="#subgraph-sampling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Subgraph Sampling</h1>

<p>ê·¸ë ‡ë‹¤ë©´ <strong>ì „ì²´ ê·¸ë˜í”„ ë§ê³  ë” ì‘ì€ subgraphë¥¼ ì¶”ì¶œí•˜ì—¬ subgraphì— ëŒ€í•´ full-batch trainingì„ ì ìš©í•˜ë©´ ì–´ë–¨ê¹Œìš”?</strong> ì¦‰, ì´ ì•„ì´ë””ì–´ëŠ” ê³§ <strong>mini-batchë¥¼ ì „ì²´ ê·¸ë˜í”„ì—ì„œ ì¶”ì¶œí•œ subgraphë¡œ êµ¬ì„±</strong>í•˜ì—¬ SGD trainingì„ í•˜ë©´ ë³´ë‹¤ ê³„ì‚° redundancyë¥¼ ì¤„ì´ê³ , ë” íš¨ìœ¨ì ìœ¼ë¡œ í° ê·¸ë˜í”„ë¥¼ í•™ìŠµí•  ìˆ˜ ìˆë‹¤ëŠ” ë§ê³¼ ê°™ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë ¤ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì „ì²´ ê·¸ë˜í”„ë¡œë¶€í„° GPUì— ì˜¬ë ¤ì§ˆ ìˆ˜ ìˆì„ ë²•í•œ ì‘ì€ subgraphë“¤ì„ ì˜ ì¶”ì¶œí•´ë‚´ì•¼ í•©ë‹ˆë‹¤.</p>

<p><img src="https://i.imgur.com/DqpdHeU.png" alt="Imgur"></p>

<blockquote>
  <p>ğŸ’¡ <strong>Subgraphë¡œ mini-batchë¥¼ êµ¬ì„±í•˜ì!</strong></p>
</blockquote>

<p>ê·¸ëŸ¼ ì—¬ê¸°ì„œ, ì–´ë–»ê²Œ ì „ì²´ ê·¸ë˜í”„ë¥¼ ì˜ ì„¤ëª…í•  ìˆ˜ ìˆëŠ” subgraphë“¤ì„ ì¶”ì¶œí•  ìˆ˜ ìˆì„ê¹Œìš”? Full-batch trainingì—ì„œëŠ” ì—£ì§€ë¥¼ ë”°ë¼ ì¼ì–´ë‚˜ëŠ” message passingì„ í†µí•´ ë…¸ë“œ ì„ë² ë”©ì„ ì—…ë°ì´íŠ¸í•˜ê¸° ë•Œë¬¸ì—, <strong>ì¢‹ì€ subgraphë€ ì „ì²´ ê·¸ë˜í”„ì˜ ì—£ì§€ ì—°ê²° êµ¬ì¡°ë¥¼ ì˜ ë“œëŸ¬ë‚´ëŠ” ëª¨ì–‘ìƒˆì—¬ì•¼ í•  ê²ƒì…ë‹ˆë‹¤.</strong></p>

<p><img src="https://i.imgur.com/bWeraOZ.png" alt="Imgur"></p>

<p>ìœ„ ê·¸ë¦¼ì˜ ì™¼ìª½, ì˜¤ë¥¸ìª½ subgraph ì¤‘ì— ì–´ë–¤ subgraphê°€ ë” ì¢‹ì„ê¹Œìš”? ì™¼ìª½ subgraphëŠ” ì›ë³¸ ê·¸ë˜í”„ì˜ ì»¤ë®¤ë‹ˆí‹° êµ¬ì¡°ë¥¼ ì˜ ìœ ì§€í•˜ê³  ìˆì–´ì„œ ì¢‹ì€ subgraphê°€ ë  ìˆ˜ ìˆëŠ” ë°˜ë©´, ì˜¤ë¥¸ìª½ subgraphëŠ” ì›ë³¸ ê·¸ë˜í”„ì˜ ì¤‘ìš”í•œ ì—£ì§€ë“¤ì„ ë§ì´ ë²„ë¦° êµ¬ì¡°ê¸° ë•Œë¬¸ì— ì•ˆ ì¢‹ì€ subgraphë¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŠ¹íˆë‚˜ ì˜¤ë¥¸ìª½ subgraphì—ì„œ ìƒê¸´ ê³ ë¦½ëœ ë…¸ë“œë“¤ì€ ì–´ë– í•œ ì—£ì§€ë¡œë„ ì—°ê²° ë˜ì–´ ìˆì§€ ì•Šê¸° ë•Œë¬¸ì— ë…¸ë“œ ì„ë² ë”©ì„ ì œëŒ€ë¡œ ë§Œë“¤ ìˆ˜ ì—†ì„ ê²ƒì…ë‹ˆë‹¤.</p>

<h1 id="exploiting-community-structure">
<a class="anchor" href="#exploiting-community-structure" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exploiting Community Structure</h1>

<p><img src="https://i.imgur.com/yOfDJEP.png" alt="Imgur"></p>

<p>13ì¥ì—ì„œ ì„¤ëª…í•˜ì˜€ë“¯ì´ ì‹¤ìƒí™œì— ì“°ì´ëŠ” ëŒ€ë¶€ë¶„ì˜ ê·¸ë˜í”„ëŠ” ìœ„ì™€ ê°™ì´ ì»¤ë®¤ë‹ˆí‹° êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤. ë”°ë¼ì„œ ì¢‹ì€ subgraphë¡œ mini-batchë¥¼ êµ¬ì„±í•˜ê¸° ìœ„í•´ <strong>ì›ë³¸ ê·¸ë˜í”„ì˜ êµ­ì†Œì  ì—£ì§€ ì—°ê²° êµ¬ì¡°ë¥¼ ì˜ ë³´ì¡´í•˜ê³  ìˆëŠ” ì»¤ë®¤ë‹ˆí‹°ê°€ subgraphë¡œ ì‚¬ìš©ë˜ëŠ” ê²ƒì´ ì¢‹ì•„ ë³´ì…ë‹ˆë‹¤.</strong></p>

<blockquote>
  <p>ğŸ’¡ <strong>ì›ë³¸ ê·¸ë˜í”„ì˜ ì»¤ë®¤ë‹ˆí‹° êµ¬ì¡°ë¥¼ subgraphë¡œ ì‚¬ìš©í•˜ì!</strong></p>
</blockquote>

<h1 id="cluster-gcn">
<a class="anchor" href="#cluster-gcn" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cluster-GCN</h1>

<p>Cluster-GCNì€ mini-batchë¡œ subgraphë¥¼ ì“°ìëŠ” ì•„ì´ë””ì–´ë¡œë¶€í„° ì œì•ˆë˜ì—ˆìœ¼ë©° ë‘ ë‹¨ê³„ë¥¼ í†µí•´ í•™ìŠµì´ ìˆ˜í–‰ë©ë‹ˆë‹¤.</p>

<p><img src="https://i.imgur.com/cl9AjCs.png" alt="Imgur"></p>

<ol>
  <li>
    <p><strong>Pre-processing</strong></p>

    <p><img src="https://i.imgur.com/Pisbjr3.png" alt="Imgur"></p>

    <p>ì›ë³¸ì˜ í° ê·¸ë˜í”„ $G$ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ì•„ë¬´ scalableí•œ community detection ì•Œê³ ë¦¬ì¦˜ (e.g., Louvain, METIS, BigCLAM ë“±)ì„ ì‚¬ìš©í•´ì„œ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ <strong>$G_i$ë¡œ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ë¶„ë¦¬í•´ëƒ…ë‹ˆë‹¤</strong>. ì´ ë•Œ, ê° ì»¤ë®¤ë‹ˆí‹° $G_i$ê°€ subgraphë¡œ ì‚¬ìš©ë  ê²ƒì´ê¸° ë•Œë¬¸ì— ì»¤ë®¤ë‹ˆí‹° ë‚´ë¶€ì˜ ì—£ì§€ëŠ” ë³´ì¡´í•˜ë˜ ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´ì˜ ì—£ì§€ëŠ” ë²„ë¦½ë‹ˆë‹¤. ì—¬ê¸°ì„œ subgraphë¥¼ ëœë¤í•˜ê²Œ ë½‘ì•„ì„œ mini-batchë¡œ ì‚¬ìš©í•  ê²ƒì´ê¸° ë•Œë¬¸ì— ê° subgraphëŠ” GPUì— í†µì§¸ë¡œ ì˜¬ë¦´ ìˆ˜ ìˆì„ í¬ê¸°ì—¬ì•¼ê² ì£ ?</p>
  </li>
  <li>
    <p><strong>Mini-batch training</strong></p>

    <p><img src="https://i.imgur.com/js9jJiK.png" alt="Imgur"></p>

    <p><strong>ì—¬ëŸ¬ subgraph ì¤‘ ëœë¤í•˜ê²Œ ë½‘ì€ í•˜ë‚˜ (í¸ì˜ìƒ $G_c$ë¼ê³  í•˜ê² ìŠµë‹ˆë‹¤!) ë¥¼ mini-batchë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.</strong> ì´ì œ ì´ ì˜¨ì „í•œ ê·¸ë˜í”„ì— ëŒ€í•˜ì—¬ <strong>full-batch trainingì„ í†µí•´ ë…¸ë“œ ì„ë² ë”©ì„ ìƒì„±</strong>í•˜ë©´ ë©ë‹ˆë‹¤. ì´í›„ë¡œëŠ” ë™ì¼í•˜ê²Œ downstream taskì— ê±¸ë§ëŠ” mini-batchì˜ loss ê°’ì´ ê³„ì‚°ë˜ê³ , ì—­ì „íŒŒë¥¼ í†µí•´ í•œë²ˆ GNN ëª¨ë¸ì˜ íŒŒë¼ë¯¸í„°ê°€ ì—…ë°ì´íŠ¸ ë˜ê² ë„¤ìš”. ê³„ì† full-batch trainingì˜ ê³„ì‚°ìƒ íš¨ìœ¨ì„± ë•Œë¬¸ì— Cluster-GCNì´ ì œì•ˆë˜ì—ˆë‹¤ë©´ì„œ êµì•ˆì—ëŠ” mini-batch trainingì´ë¼ëŠ” ìš©ì–´ê°€ ì“°ì—¬ì„œ í˜¹ì—¬ë‚˜ í—·ê°ˆë¦¬ì‹¤ê¹Œë´ ë§ë¶™ì—¬ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ê²°êµ­ subgraphë¥¼ mini-batchë¡œ í™œìš©í•˜ì—¬ í•™ìŠµì„ ì§„í–‰í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— í¬ê²Œ ë³´ë©´ SGD, ì¦‰ mini-batch trainingì˜ ë²”ì£¼ì— í¬í•¨ë˜ëŠ” ê²ƒì´ ë§ìŠµë‹ˆë‹¤. ë‹¤ë§Œ, mini-batch ìì²´ê°€ Neighbor Samplingì—ì„œ ì²˜ëŸ¼ ë”°ë¡œë”°ë¡œ êµ¬ë¶„ëœ computation graphë¡œ êµ¬ì„±ë˜ëŠ” ê²ƒì´ ì•„ë‹ˆê³  í•˜ë‚˜ì˜ ì˜¨ì „í•œ ê·¸ë˜í”„ ëª¨ì–‘ì„ ê°–ëŠ” subgraphì´ê¸° ë•Œë¬¸ì—, í•œë²ˆì— ë…¸ë“œ ì„ë² ë”©ì„ ìƒì„±í•´ë²„ë¦¬ëŠ” full-batch trainingì²˜ëŸ¼ í•™ìŠµí•  ìˆ˜ ìˆëŠ” ê²ƒì…ë‹ˆë‹¤!</p>
  </li>
</ol>

<h1 id="issues-with-cluster-gcn">
<a class="anchor" href="#issues-with-cluster-gcn" aria-hidden="true"><span class="octicon octicon-link"></span></a>Issues with Cluster-GCN</h1>

<p><img src="https://i.imgur.com/xPuh2l6.png" alt="Imgur"> <img src="https://i.imgur.com/739L1gl.png" alt="Imgur"></p>

<p>í•˜ì§€ë§Œ Cluster-GCNì—ë„ ë¬¸ì œëŠ” ìˆìŠµë‹ˆë‹¤. <strong>ê·¸ë˜í”„ community detectionì€ ë¹„ìŠ·í•œ ë…¸ë“œë“¤ì„ ê°™ì€ ì»¤ë®¤ë‹ˆí‹°ì— ì§‘ì–´ë„£ê¸° ë•Œë¬¸ì— ì¶”ì¶œë˜ëŠ” subgraphë“¤ì€ ì›ë³¸ ê·¸ë˜í”„ë¥¼ ëŒ€í‘œí•œë‹¤ê³  ë³¼ ìˆ˜ ì—†ì„ ë¿ë”ëŸ¬ ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´ì˜ ì—£ì§€ë“¤ì´ ì†Œì‹¤ë˜ë©° ì¤‘ìš”í•œ ë©”ì„¸ì§€ë“¤ì„ ìƒì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</strong> 13ê°•ì˜ Granovetterì˜ ì‹¤í—˜ì„ ë˜ì§šì–´ë³´ë©´ ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´ì˜ ì—°ê²°ë¡œë¶€í„° ì§ì—… ì†Œê°œì™€ ê°™ì€ ì¤‘ìš”í•œ ì •ë³´ë“¤ì´ ë§ì´ ì „ë‹¬ëœë‹¤ëŠ” ê±° ê¸°ì–µë‚˜ì‹œì£ ? ì¤‘ìš”í•œ ì—£ì§€ë“¤ì´ ì†Œì‹¤ë¨ì— ë”°ë¼ subgraph ë§ˆë‹¤ ë§ˆë‹¤ ê³„ì‚°ëœ gradient ê°’ì˜ í¸ì°¨ê°€ ì‹¬í•  ê²ƒì´ê³ , ì´ëŠ” í•™ìŠµì˜ ë¶ˆì•ˆì •ì„±ì„ ì•¼ê¸°í•˜ë©° ìˆ˜ë ´ ì†ë„ë¥¼ ë”ë””ê²Œ í•©ë‹ˆë‹¤.</p>

<h1 id="advanced-cluster-gcn-overview">
<a class="anchor" href="#advanced-cluster-gcn-overview" aria-hidden="true"><span class="octicon octicon-link"></span></a>Advanced Cluster-GCN: Overview</h1>

<p><img src="https://i.imgur.com/9Q6wYSR.png" alt="Imgur"></p>

<p><strong>ì´ëŸ¬í•œ ë¬¸ì œëŠ” ì—¬ëŸ¬ ì»¤ë®¤ë‹ˆí‹° (subgraph)ë¥¼ í•˜ë‚˜ì˜ mini-batchì— ê°™ì´ ë„£ìŒìœ¼ë¡œì¨ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</strong> ì´ëŸ° ë°©ì‹ìœ¼ë¡œ mini-batchë¥¼ êµ¬ì„±í•œë‹¤ë©´, subgraph ë‚´ì— ë¡œì»¬ ì»¤ë®¤ë‹ˆí‹° êµ¬ì¡°ë„ ë³´ì¡´í•˜ë©´ì„œ ë™ì‹œì— <strong>ì»¤ë®¤ë‹ˆí‹° ê°„ ì—£ì§€ë„ í¬í•¨</strong>í•˜ê²Œ ë˜ë©´ì„œ ë³´ë‹¤ ì›ë³¸ ê·¸ë˜í”„ë¥¼ ì˜ ëŒ€í‘œí•  ìˆ˜ ìˆëŠ” subgraphë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ community detectionì‹œì— ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´ì¦ˆë¥¼ ì¢€ ë” ì‘ê²Œ í•¨ìœ¼ë¡œ ì—¬ëŸ¬ ì»¤ë®¤ë‹ˆí‹°ë¥¼ í•©ì³ì„œ subgraphë¥¼ ë§Œë“¤ ë•Œì—ë„ subgraphê°€ GPUì— ì˜ ì˜¬ë¼ê°€ë„ë¡ í•´ì•¼ í•¨ì— ì£¼ì˜í•˜ì„¸ìš”.</p>

<blockquote>
  <p>ğŸ’¡ <strong>ì—¬ëŸ¬ ê°œì˜ ì»¤ë®¤ë‹ˆí‹° êµ¬ì¡°ë¥¼ í•©ì³ì„œ subgraphë¡œ ì‚¬ìš©í•˜ì!</strong></p>
</blockquote>

<h1 id="advanced-cluster-gcn">
<a class="anchor" href="#advanced-cluster-gcn" aria-hidden="true"><span class="octicon octicon-link"></span></a>Advanced Cluster-GCN</h1>

<p>Advanced Cluster-GCNì˜ ë‘ ë‹¨ê³„ ë˜í•œ subgraphë¥¼ ìƒì„±í•˜ëŠ” ë¶€ë¶„ ì´ì™¸ì—ëŠ” vanilla Cluster-GCNê³¼ ë™ì¼í•˜ê¸° ë•Œë¬¸ì— ê°„ëµí•˜ê²Œë§Œ ì–¸ê¸‰í•˜ê³  ë„˜ì–´ê°€ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<ol>
  <li>
    <p><strong>Pre-processing</strong></p>

    <p>Community detection ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•˜ì—¬ ì›ë³¸ ê·¸ë˜í”„ë¥¼ ì—¬ëŸ¬ ì»¤ë®¤ë‹ˆí‹°ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤. ì´ ë•Œ, ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´ì¦ˆë¥¼ ì‘ê²Œ í•˜ì—¬ detectionì„ ì§„í–‰í•˜ë„ë¡ í•©ë‹ˆë‹¤.</p>
  </li>
  <li>
    <p><strong>Mini-batch training</strong></p>

    <p>ë¶„ë¦¬ëœ ì—¬ëŸ¬ ì»¤ë®¤ë‹ˆí‹° ì¤‘ ëª‡ ê°œë¥¼ ëœë¤í•˜ê²Œ ê³¨ë¼ aggregate í•¨ìœ¼ë¡œì¨ subgraph, ì¦‰ mini-batchë¥¼ êµ¬ì„±í•  ê²ƒì…ë‹ˆë‹¤. ì´ ë•Œ, <strong>ì»¤ë®¤ë‹ˆí‹° ì‚¬ì´ì˜ ì—£ì§€ ë˜í•œ ë³´ì¡´ë¨ì— ì£¼ëª©í•˜ì„¸ìš”</strong>!</p>
  </li>
</ol>

<h1 id="comparison-of-time-complexity">
<a class="anchor" href="#comparison-of-time-complexity" aria-hidden="true"><span class="octicon octicon-link"></span></a>Comparison of Time Complexity</h1>

<p>ì, ê·¸ëŸ¼ ì§€ê¸ˆê¹Œì§€ í° ê·¸ë˜í”„ë¥¼ GNNìœ¼ë¡œ í•™ìŠµí•˜ê¸° ìœ„í•´ ë°°ìš´ ë‘ ê°€ì§€ ë°©ë²•, Neighbor Samplingê³¼ Cluster-GCNì„ ì‹œê°„ ë³µì¡ë„ ì¸¡ë©´ì—ì„œ ë¹„êµí•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. ë‘ ë°©ë²•ì—ì„œ ëª¨ë‘ ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì€ $K$ê°œì˜ GNN layerì„ ê°€ì§€ë©°, mini-batchì˜ ì‚¬ì´ì¦ˆëŠ” $M$ì´ë¼ê³  ê°€ì •í•˜ê² ìŠµë‹ˆë‹¤.</p>

<ul>
  <li>
    <p><strong>Neighbor Sampling (Sampling factor = $H$ì¼ ë•Œ)</strong><br></p>

    <p><img src="https://i.imgur.com/xVEmTPn.png" alt="Imgur"></p>

    <p>ì´ ë°©ë²•ì˜ ê²½ìš° í•œ mini-batchê°€ $M$ê°œì˜ computation graphë“¤ë¡œ êµ¬ì„±ë˜ë©°, ê° computation graphì—ì„œ í•œ ë…¸ë“œ ë‹¹ $H$ê°œì˜ ì´ì›ƒ ë…¸ë“œë§Œì´ ìƒ˜í”Œë§ë˜ë©° $H^K$ì˜ í¬ê¸°ë¥¼ ê°–ê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì „ì²´ ì‹œê°„ ë³µì¡ë„ëŠ” $M \cdot H^K$ ì…ë‹ˆë‹¤.</p>
    <blockquote>
      <p><strong>ì‹œê°„ ë³µì¡ë„ =</strong> $O(M \cdot H^K)$</p>

    </blockquote>
  </li>
  <li>
    <p><strong>Cluster-GCN</strong></p>

    <p>í•œ mini-batchì— ëŒ€í•´ ê³„ì‚°ë˜ëŠ” ì‹œê°„ ë³µì¡ë„ëŠ” subgraph ë‚´ ì—£ì§€ì˜ ìˆ˜ì— ë¹„ë¡€í•©ë‹ˆë‹¤. ë§Œì•½ ì „ì²´ ê·¸ë˜í”„ì— ëŒ€í•œ í‰ê·  ì°¨ìˆ˜ê°€ $D_{avg}$ì´ë¼ë©´, mini-batchë¡œ ì‚¬ìš©ë˜ëŠ” subgraph ë‚´ì˜ ë…¸ë“œ ê°¯ìˆ˜ê°€ $M$ê°œì´ê¸° ë•Œë¬¸ì— ì „ì²´ ì—£ì§€ ìˆ˜ëŠ” $M \cdot D_{avg}$ê°€ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì „ì²´ $K$ layerì— ëŒ€í•œ ì‹œê°„ ë³µì¡ë„ëŠ” $K \cdot M \cdot D_{avg}$ ì…ë‹ˆë‹¤.</p>

    <blockquote>
      <p><strong>ì‹œê°„ ë³µì¡ë„ =</strong> $O(K \cdot M \cdot D_{avg})$</p>

    </blockquote>
  </li>
</ul>

<p>ì¼ë°˜ì ìœ¼ë¡œ ì‹œê°„ ë³µì¡ë„ê°€ GNN layerì˜ ê°¯ìˆ˜ $K$ì— ì§€ìˆ˜ì ìœ¼ë¡œ ë¹„ë¡€í•˜ëŠ” Neighbor Samplingì— ë¹„í•´ ì„ í˜• ë¹„ë¡€í•˜ëŠ” Cluster-GCNì´ ê³„ì‚° ì¸¡ë©´ìœ¼ë¡œëŠ” ë” íš¨ìœ¨ì ì´ë¼ê³  í•©ë‹ˆë‹¤. ë‹¤ë§Œ, ë§Œì•½ $K$ë¥¼ ì‘ê²Œ ë‘ëŠ” ê²½ìš°ì— ë³´í†µ í˜„ì—…ì—ì„œëŠ” Neighbor Sampling ë°©ì‹ì´ ë” ìš°ì„¸í•˜ë‹¤ê³  í•˜ëŠ”ë°ìš”, ì´ëŠ” Cluster-GCN ë°©ë²•ì´ Neighbor Sampling ë°©ì‹ì— ë¹„í•´ ì›ë³¸ ê·¸ë˜í”„ë¥¼ ì˜ ëŒ€í‘œí•  ìˆ˜ ìˆëŠ” mini-batchë¥¼ êµ¬ì„±í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì´ë¼ê³  í•©ë‹ˆë‹¤. ì–´ì¨Œê±°ë‚˜ Cluster-GCN ë°©ë²•ì€ community detectionì„ í†µí•´ ì¶”ì¶œëœ ì»¤ë®¤ë‹ˆí‹° êµ¬ì¡°ì— í¬ê²Œ ì˜ì¡´í•˜ê³  ìˆìœ¼ë‹ˆê¹Œìš” ğŸ™‚</p>

<h1 id="summary-cluster-gcn">
<a class="anchor" href="#summary-cluster-gcn" aria-hidden="true"><span class="octicon octicon-link"></span></a>Summary: Cluster-GCN</h1>

<blockquote>
  <p>ğŸ’¡ <strong>1.  GNN êµ¬ì¡° : ê·¸ëŒ€ë¡œ ì‚¬ìš©<br>2.  Mini-batch êµ¬ì„± ë°©ì‹: ì»¤ë®¤ë‹ˆí‹° êµ¬ì¡°ë¥¼ í¬í•¨í•˜ëŠ” subgraphë¡œ êµ¬ì„±<br>3.  í•™ìŠµ ë°©ì‹: SGD training</strong></p>
</blockquote>

<ul>
  <li>Cluster-GCNì€ ë¨¼ì € community detectionì„ í†µí•´ ì›ë³¸ ê·¸ë˜í”„ë¥¼ ì—¬ëŸ¬ ì»¤ë®¤ë‹ˆí‹°ë¡œ ë¶„ë¦¬í•¨</li>
  <li>ì—¬ëŸ¬ ì»¤ë®¤ë‹ˆí‹°ê°€ í•©ì³ì§„ subgraphê°€ mini-batchë¡œ ì‚¬ìš©ë¨</li>
  <li>ì˜¨ì „í•œ ê·¸ë˜í”„ ëª¨ì–‘ì„ ë ëŠ” mini-batchì— ëŒ€í•´ full-batch trainingì´ ìˆ˜í–‰ë¨</li>
  <li>$K$ê°€ í´ ë•Œ Cluster-GCNì€ Neighbor Samplingì— ë¹„í•´ ë” íš¨ìœ¨ì ì„</li>
  <li>í•˜ì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ Cluster-GCNì€ í¸í–¥ëœ gradientë¥¼ ë§Œë“¤ê²Œ ë˜ëŠ”ë°, $K$ê°€ ì»¤ì§„ë‹¤ í•˜ë”ë¼ë„ ë™ì¼ êµ¬ì¡°ì˜ subgraphì— ëŒ€í•´ì„œë§Œ aggregationì´ ì¼ì–´ë‚˜ë¯€ë¡œ ì§„ì§œ ì›ë³¸ ê·¸ë˜í”„ë¥¼ $K$-hopë§Œí¼ exploreí•˜ëŠ” íš¨ê³¼ë¥¼ ë‚¼ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì„</li>
</ul>

<hr>

  </div><!-- from https://github.com/utterance/utterances
<script src="https://utteranc.es/client.js"
        repo="CS224W-KOR/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>-->

<div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://cs224w-kor.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a class="u-url" href="/blog/gnn/scalable/large%20graph/graphsage/cluster%20gcn/simplified%20gcn/2022/09/07/lecture-1703.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>CS224W ê°•ì˜ë¥¼ ê³µë¶€í•˜ëŠ” ê¸€ë˜ ê·¸ë˜í”„ ìŠ¤í„°ë”” ë¸”ë¡œê·¸</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/cs224w-kor" target="_blank" title="cs224w-kor"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
